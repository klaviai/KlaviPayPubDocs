[{"title":"Introduction","type":0,"sectionRef":"#","url":"/docs","content":"Introduction Welcome to the Klavi development documentation and API reference! Klavi payment initiation product support two method integration: Payment page and Payment API. Payment page: The simplest and fastest integration method for payment initiation.Payment API: This approach requires partners to have back-end system development and integration capabilities. note Before you get started, you must first create a Klavi account and create an API accessKey and secretKey. If you have any questions along the way, please don’t hesitate to talk to us at suporte@klavi.ai.","keywords":""},{"title":"Cancel the payment initiation","type":0,"sectionRef":"#","url":"/docs/api-reference/customer/payments/cancel-payment","content":"","keywords":""},{"title":"Request​","type":1,"pageTitle":"Cancel the payment initiation","url":"/docs/api-reference/customer/payments/cancel-payment#request","content":""},{"title":"Request method​","type":1,"pageTitle":"Cancel the payment initiation","url":"/docs/api-reference/customer/payments/cancel-payment#request-method","content":"POST https://api-test.klavi.ai/payment/customer/v1/payments/{id}/cancel  "},{"title":"Request Header​","type":1,"pageTitle":"Cancel the payment initiation","url":"/docs/api-reference/customer/payments/cancel-payment#request-header","content":"Attribute\tType\tCondition\tDescriptionAuthorization\tString\trequired\tJWT bearer token obtained through /auth endpoint, When passing, add &quot;Bearer &quot; before the token "},{"title":"Request Path Parameters​","type":1,"pageTitle":"Cancel the payment initiation","url":"/docs/api-reference/customer/payments/cancel-payment#request-path-parameters","content":"Attribute\tType\tCondition\tDescriptionid\tString\trequired\tpayment_id, it will be returned when POST /payments is called. "},{"title":"Response​","type":1,"pageTitle":"Cancel the payment initiation","url":"/docs/api-reference/customer/payments/cancel-payment#response","content":""},{"title":"Code: 200​","type":1,"pageTitle":"Cancel the payment initiation","url":"/docs/api-reference/customer/payments/cancel-payment#code-200","content":"{ &quot;code&quot;: 200, &quot;message&quot;: &quot;OK&quot;, &quot;data&quot;: null }  "},{"title":"Authenticate initiation interface","type":0,"sectionRef":"#","url":"/docs/api-reference/customer/auth/auth-interface","content":"","keywords":""},{"title":"Request​","type":1,"pageTitle":"Authenticate initiation interface","url":"/docs/api-reference/customer/auth/auth-interface#request","content":""},{"title":"Request method​","type":1,"pageTitle":"Authenticate initiation interface","url":"/docs/api-reference/customer/auth/auth-interface#request-method","content":"POST https://api-test.klavi.ai/payment/customer/v1/auth-payment  "},{"title":"Request Header​","type":1,"pageTitle":"Authenticate initiation interface","url":"/docs/api-reference/customer/auth/auth-interface#request-header","content":"None. "},{"title":"Request Path Parameters​","type":1,"pageTitle":"Authenticate initiation interface","url":"/docs/api-reference/customer/auth/auth-interface#request-path-parameters","content":"None. "},{"title":"Request Body parameters​","type":1,"pageTitle":"Authenticate initiation interface","url":"/docs/api-reference/customer/auth/auth-interface#request-body-parameters","content":"Attribute\tType\tCondition\tDescriptionaccessKey\tString\trequired\tPre-generated by KlaviPay for partner secretKey\tString\trequired\tPre-generated by KlaviPay for partner payment\tObject\trequired participantId\tString\trequired user\tObject\trequired name\tString\toptional taxId\tString\toptional amount\tString\toptional\t "},{"title":"Response​","type":1,"pageTitle":"Authenticate initiation interface","url":"/docs/api-reference/customer/auth/auth-interface#response","content":""},{"title":"Code: 200​","type":1,"pageTitle":"Authenticate initiation interface","url":"/docs/api-reference/customer/auth/auth-interface#code-200","content":"{ &quot;token&quot;: &quot;eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCJ9.eyJwYXlsbLWdhdGV3YXkifQ.2dvWMBcU87IeX4J7S1_bx1uKHsXAvSDaK0RdV9xq3-OSrLA&quot;, &quot;paymentId&quot;: &quot;fcb72e3a-b346-4f71-b044-971dc23232c9&quot; }  "},{"title":"Authenticate initiation","type":0,"sectionRef":"#","url":"/docs/api-reference/customer/auth/authentication","content":"","keywords":""},{"title":"Request​","type":1,"pageTitle":"Authenticate initiation","url":"/docs/api-reference/customer/auth/authentication#request","content":""},{"title":"Request method​","type":1,"pageTitle":"Authenticate initiation","url":"/docs/api-reference/customer/auth/authentication#request-method","content":"POST https://api-test.klavi.ai/payment/customer/v1/auth  "},{"title":"Request Header​","type":1,"pageTitle":"Authenticate initiation","url":"/docs/api-reference/customer/auth/authentication#request-header","content":"None. "},{"title":"Request Path Parameters​","type":1,"pageTitle":"Authenticate initiation","url":"/docs/api-reference/customer/auth/authentication#request-path-parameters","content":"None. "},{"title":"Request Body parameters​","type":1,"pageTitle":"Authenticate initiation","url":"/docs/api-reference/customer/auth/authentication#request-body-parameters","content":"Attribute\tType\tCondition\tDescriptionaccessKey\tString\trequired\tPre-generated by KlaviPay for partner secretKey\tString\trequired\tPre-generated by KlaviPay for partner "},{"title":"Response​","type":1,"pageTitle":"Authenticate initiation","url":"/docs/api-reference/customer/auth/authentication#response","content":""},{"title":"Code: 200​","type":1,"pageTitle":"Authenticate initiation","url":"/docs/api-reference/customer/auth/authentication#code-200","content":"{ &quot;token&quot;: &quot;eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCJ9.eyJwYXlsbLWdhdGV3YXkifQ.2dvWMBcU87IeX4J7S1_bx1uKHsXAvSDaK0RdV9xq3-OSrLA&quot;, &quot;expire&quot;: &quot;2023-02-16T17:16:30.189341+08:00&quot; }  "},{"title":"Get payment status","type":0,"sectionRef":"#","url":"/docs/api-reference/customer/payments/get-status","content":"","keywords":""},{"title":"Request​","type":1,"pageTitle":"Get payment status","url":"/docs/api-reference/customer/payments/get-status#request","content":""},{"title":"Request method​","type":1,"pageTitle":"Get payment status","url":"/docs/api-reference/customer/payments/get-status#request-method","content":"GET https://api-test.klavi.ai/payment/customer/v1/payments/{id}/status  "},{"title":"Request Header​","type":1,"pageTitle":"Get payment status","url":"/docs/api-reference/customer/payments/get-status#request-header","content":"Attribute\tType\tCondition\tDescriptionAuthorization\tString\trequired\tJWT bearer token obtained through /auth endpoint, When passing, add &quot;Bearer &quot; before the token "},{"title":"Request Path Parameters​","type":1,"pageTitle":"Get payment status","url":"/docs/api-reference/customer/payments/get-status#request-path-parameters","content":"Attribute\tType\tCondition\tDescriptionid\tString\trequired\tpayment_id, it will be returned when POST /payments is called. "},{"title":"Response​","type":1,"pageTitle":"Get payment status","url":"/docs/api-reference/customer/payments/get-status#response","content":""},{"title":"Code: 200​","type":1,"pageTitle":"Get payment status","url":"/docs/api-reference/customer/payments/get-status#code-200","content":"{ &quot;id&quot;:&quot;b468a20f-b536-4bf7-a597-7ba91f73beb4&quot;, &quot;createdAt&quot;:&quot;2023-03-07T13:49:40.136Z&quot;, &quot;updatedAt&quot;:&quot;2023-03-07T13:49:49.355Z&quot;, &quot;consentId&quot;:&quot;urn:raidiambank:170da788-0671-469d-9430-64186362a68e&quot;, &quot;status&quot;:&quot;CONSENT_AWAITING_AUTHORIZATION&quot;, &quot;redirectConsentURL&quot;:&quot;https://auth.mockbank.poc.raidiam.io/auth?client_id=bfPGzGSxugMq_ORhPbkmb&amp;scope=openid&amp;redirect_uri=https%3A%2F%2Fcallback.sandbox.inic.dev%2Fv1%2Fcallback&amp;request_uri=urn%3Aietf%3Aparams%3Aoauth%3Arequest_uri%3Ah1kFo1-rXM7T6dPi9HPwf&amp;prompt=consent&quot;, &quot;externalId&quot;:&quot;92a081b7eac9-4af5-9446&quot; }  Payment status details refer to: Payment status "},{"title":"List payments initiations","type":0,"sectionRef":"#","url":"/docs/api-reference/customer/payments/list-payments","content":"","keywords":""},{"title":"Request​","type":1,"pageTitle":"List payments initiations","url":"/docs/api-reference/customer/payments/list-payments#request","content":""},{"title":"Request method​","type":1,"pageTitle":"List payments initiations","url":"/docs/api-reference/customer/payments/list-payments#request-method","content":"GET https://api-test.klavi.ai/payment/customer/v1/payments  "},{"title":"Request Header​","type":1,"pageTitle":"List payments initiations","url":"/docs/api-reference/customer/payments/list-payments#request-header","content":"Attribute\tType\tCondition\tDescriptionAuthorization\tString\trequired\tJWT bearer token obtained through /auth endpoint, When passing, add &quot;Bearer &quot; before the token "},{"title":"Request Path Parameters​","type":1,"pageTitle":"List payments initiations","url":"/docs/api-reference/customer/payments/list-payments#request-path-parameters","content":"Attribute\tType\tCondition\tDescriptionlimit\tNumber\toptional\tLimit payments list length "},{"title":"Response​","type":1,"pageTitle":"List payments initiations","url":"/docs/api-reference/customer/payments/list-payments#response","content":""},{"title":"Code: 200​","type":1,"pageTitle":"List payments initiations","url":"/docs/api-reference/customer/payments/list-payments#code-200","content":"[ { &quot;id&quot;: &quot;ffcf6b93-9184-447f-b806-98a803dbd954&quot;, &quot;createdAt&quot;: &quot;2023-02-02T07:12:47.965Z&quot;, &quot;updatedAt&quot;: &quot;0001-01-01T00:00:00Z&quot;, &quot;error&quot;: {}, &quot;status&quot;: &quot;STARTED&quot;, &quot;clientId&quot;: &quot;0b59d801-08e0-4e84-9ecd-569f34e32279&quot;, &quot;customerId&quot;: &quot;21a79744-39c8-4b37-b7a9-cb50b0389448&quot;, &quot;provider&quot;: { &quot;tradeName&quot;: &quot;Klavi&quot;, &quot;avatar&quot;: &quot;https://media.licdn.com/dms/image/C4D0BAQGwqthFsnjhpw/company-logo_200_200/0/1647885722250?e=1681948800&amp;v=beta&amp;t=A7-Ks2EcodobZmHhOutvZ6IS3OgjfHDclmuS7sSjRfs&quot; }, &quot;user&quot;: { &quot;taxId&quot;: &quot;&quot; }, &quot;businessEntity&quot;: { &quot;taxId&quot;: &quot;&quot; }, &quot;method&quot;: &quot;&quot;, &quot;amount&quot;: 0, &quot;date&quot;: &quot;2023-02-02&quot;, &quot;debtor&quot;: { &quot;number&quot;: &quot;&quot;, &quot;accountType&quot;: &quot;&quot;, &quot;ispb&quot;: &quot;&quot;, &quot;issuer&quot;: &quot;&quot;, &quot;bank&quot;: { &quot;id&quot;: &quot;c8f0bf49-4744-4933-8960-7add6e590841&quot;, &quot;name&quot;: &quot;Mock Bank&quot;, &quot;avatar&quot;: &quot;https://cdn.raidiam.io/directory-ui/brand/obbrazil/0.2.0.112/favicon.svg&quot; } }, &quot;creditor&quot;: { &quot;taxId&quot;: &quot;38231713000139&quot;, &quot;name&quot;: &quot;Klavi&quot;, &quot;number&quot;: &quot;********&quot;, &quot;accountType&quot;: &quot;CACC&quot;, &quot;ispb&quot;: &quot;60701190&quot;, &quot;issuer&quot;: &quot;****&quot;, &quot;bank&quot;: { &quot;id&quot;: &quot;&quot; } } } ]  "},{"title":"FAQ","type":0,"sectionRef":"#","url":"/docs/dev-guides/faq","content":"FAQ Which integration method can realize payment business fastest? Using the white label application provided by KlaviPay is the easiest and fastest method to realize payment business. What are the differences between the two integration methods of white label application (WebView and iFrame)? There are different ways to obtain payment results in the two integration methods: Integration with WebView: The customer needs to develop a page corresponding to the callback url to obtain the final payment status.Integration with iFrame: The final payment status is obtained by receiving the status submitted by the targetWindows.postMessage() of the KlaviPay application.","keywords":""},{"title":"List participants","type":0,"sectionRef":"#","url":"/docs/api-reference/customer/participants/participant","content":"","keywords":""},{"title":"Request​","type":1,"pageTitle":"List participants","url":"/docs/api-reference/customer/participants/participant#request","content":""},{"title":"Request method​","type":1,"pageTitle":"List participants","url":"/docs/api-reference/customer/participants/participant#request-method","content":"GET https://api-test.klavi.ai/payment/customer/v1/participants  "},{"title":"Request Header​","type":1,"pageTitle":"List participants","url":"/docs/api-reference/customer/participants/participant#request-header","content":"Attribute\tType\tCondition\tDescriptionAuthorization\tString\trequired\tJWT bearer token obtained through /auth endpoint, When passing, add &quot;Bearer &quot; before the token "},{"title":"Request Path Parameters​","type":1,"pageTitle":"List participants","url":"/docs/api-reference/customer/participants/participant#request-path-parameters","content":"None. "},{"title":"Request Body parameters​","type":1,"pageTitle":"List participants","url":"/docs/api-reference/customer/participants/participant#request-body-parameters","content":"None. "},{"title":"Response​","type":1,"pageTitle":"List participants","url":"/docs/api-reference/customer/participants/participant#response","content":""},{"title":"Code: 200​","type":1,"pageTitle":"List participants","url":"/docs/api-reference/customer/participants/participant#code-200","content":"[ { &quot;id&quot;: &quot;cc26199f-4949-4efd-9e1e-f21a34fd0239&quot;, &quot;name&quot;: &quot;Banco Bmg S.A&quot;, &quot;slug&quot;: &quot;banco-bmg-sa&quot;, &quot;avatar&quot;: &quot;https://www.bancobmg.com.br/data/files/8C/A2/7F/0A/FBA318104A94D208970BE9C2/bmg_open_finance.svg&quot; }, { &quot;id&quot;: &quot;f9cabb03-876d-4eea-974c-0d8ce4bd4860&quot;, &quot;name&quot;: &quot;banco Digio&quot;, &quot;slug&quot;: &quot;banco-digio&quot;, &quot;avatar&quot;: &quot;https://static.digio.com.br/media/logo_81e95ae2ab.svg&quot; }, { &quot;id&quot;: &quot;75db457a-612d-4d62-b557-ba9d32b05216&quot;, &quot;name&quot;: &quot;Banco do Brasil&quot;, &quot;slug&quot;: &quot;banco-do-brasil&quot;, &quot;avatar&quot;: &quot;https://www.bb.com.br/docs/pub/inst/img/LogoBB.svg&quot; }, { &quot;id&quot;: &quot;c3463f74-87b3-40bd-8d40-2a918f821e31&quot;, &quot;name&quot;: &quot;Banco Original S.A&quot;, &quot;slug&quot;: &quot;banco-original-sa&quot;, &quot;avatar&quot;: &quot;https://www.original.com.br/img/logo-cubo-verde.svg&quot; }, { &quot;id&quot;: &quot;612da9a3-ee82-4f9e-9919-fa8ba88800f9&quot;, &quot;name&quot;: &quot;Banco PAN&quot;, &quot;slug&quot;: &quot;banco-pan&quot;, &quot;avatar&quot;: &quot;https://www.bancopan.com.br/data/files/83/77/FC/2A/5DE5A71033FBD5979C288204/logo_pan_openbanking.svg&quot; } ]  "},{"title":"Coming soon","type":0,"sectionRef":"#","url":"/docs/api-reference/management/comingsoon","content":"Coming soon","keywords":""},{"title":"Changelog","type":0,"sectionRef":"#","url":"/docs/dev-guides/changelog","content":"","keywords":""},{"title":"2023/02/21​","type":1,"pageTitle":"Changelog","url":"/docs/dev-guides/changelog#20230221","content":"Added Initial version "},{"title":"Authentication","type":0,"sectionRef":"#","url":"/docs/dev-guides/integration-api/authentication","content":"","keywords":""},{"title":"Introduction​","type":1,"pageTitle":"Authentication","url":"/docs/dev-guides/integration-api/authentication#introduction","content":"KlaviPay API uses JWT tokens to authenticate requests. With a accessKey and a secretKey you can get an token and pass it to the Authorization Header via bearer token. Request it at /v1/auth passing int the body the JSON: { &quot;accessKey&quot;: &quot;L0l1a2v3i4&quot;, &quot;secretKey&quot;: &quot;TtMdrH&amp;a8MfjdyUnFs*#dypaX15%qpXtXQt2n$&quot; }  Usage example: Authorization: Bearer eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCJ9...uKHsXAvSDaK0RdV9xq3-OSrLA  All requests must be done via HTTPS. Authenticated requests must be submitted with the appropriate authorization header. "},{"title":"Grant authorization​","type":1,"pageTitle":"Authentication","url":"/docs/dev-guides/integration-api/authentication#grant-authorization","content":"KlaviPay provides two types of APIs: Product API and Management API. Although both use JWT token authentication method, because of the different use scenarios of the two APIs, different accessKey and secretKey are required. "},{"title":"Get payment resource","type":0,"sectionRef":"#","url":"/docs/api-reference/customer/payments/get-resource","content":"","keywords":""},{"title":"Request​","type":1,"pageTitle":"Get payment resource","url":"/docs/api-reference/customer/payments/get-resource#request","content":""},{"title":"Request method​","type":1,"pageTitle":"Get payment resource","url":"/docs/api-reference/customer/payments/get-resource#request-method","content":"GET https://api-test.klavipay.ai/payment/customer/v1/payments/{id}  "},{"title":"Request Header​","type":1,"pageTitle":"Get payment resource","url":"/docs/api-reference/customer/payments/get-resource#request-header","content":"Attribute\tType\tCondition\tDescriptionAuthorization\tString\trequired\tJWT bearer token obtained through /auth endpoint, When passing, add &quot;Bearer &quot; before the token "},{"title":"Request Path Parameters​","type":1,"pageTitle":"Get payment resource","url":"/docs/api-reference/customer/payments/get-resource#request-path-parameters","content":"Attribute\tType\tCondition\tDescriptionid\tString\trequired\tpayment_id, it will be returned when POST /payments is called. "},{"title":"Response​","type":1,"pageTitle":"Get payment resource","url":"/docs/api-reference/customer/payments/get-resource#response","content":""},{"title":"Code: 200​","type":1,"pageTitle":"Get payment resource","url":"/docs/api-reference/customer/payments/get-resource#code-200","content":"{ &quot;id&quot;: &quot;fcb72e3a-b346-4f71-b044-971dc23232c9&quot;, &quot;createdAt&quot;: &quot;2023-01-23T14:17:06.45Z&quot;, &quot;updatedAt&quot;: &quot;0001-01-01T00:00:00Z&quot;, &quot;error&quot;: { &quot;code&quot;: &quot;NAO_INFORMADO&quot;, &quot;title&quot;: &quot;Não informado&quot;, &quot;detail&quot;: &quot;Erro não informado na iniciadora ou detentora de conta.&quot; }, &quot;status&quot;: &quot;CANCELED&quot;, &quot;externalId&quot;: &quot;dangwy&quot;, &quot;clientId&quot;: &quot;0b59d801-08e0-4e84-9ecd-569f34e32279&quot;, &quot;customerId&quot;: &quot;21a79744-39c8-4b37-b7a9-cb50b0389448&quot;, &quot;provider&quot;: { &quot;tradeName&quot;: &quot;Klavi&quot;, &quot;avatar&quot;: &quot;https://media.licdn.com/dms/image/C4D0BAQGwqthFsnjhpw/company-logo_200_200/0/1647885722250?e=1681948800&amp;v=beta&amp;t=A7-Ks2EcodobZmHhOutvZ6IS3OgjfHDclmuS7sSjRfs&quot; }, &quot;participantId&quot;: &quot;c8f0bf49-4744-4933-8960-7add6e590841&quot;, &quot;user&quot;: { &quot;taxId&quot;: &quot;12345678901&quot;, &quot;name&quot;: &quot;dang&quot; }, &quot;businessEntity&quot;: { &quot;taxId&quot;: &quot;&quot; }, &quot;method&quot;: &quot;PIX_INIC&quot;, &quot;amount&quot;: 133300, &quot;date&quot;: &quot;2023-01-23&quot;, &quot;redirectURL&quot;: &quot;https://app.sandbox.inic.dev/pag-receipt&quot;, &quot;debtor&quot;: { &quot;number&quot;: &quot;&quot;, &quot;accountType&quot;: &quot;&quot;, &quot;ispb&quot;: &quot;&quot;, &quot;issuer&quot;: &quot;&quot;, &quot;bank&quot;: { &quot;id&quot;: &quot;c8f0bf49-4744-4933-8960-7add6e590841&quot;, &quot;name&quot;: &quot;Mock Bank&quot;, &quot;avatar&quot;: &quot;https://cdn.raidiam.io/directory-ui/brand/obbrazil/0.2.0.112/favicon.svg&quot; } }, &quot;creditor&quot;: { &quot;taxId&quot;: &quot;38231713000139&quot;, &quot;name&quot;: &quot;Klavi&quot;, &quot;number&quot;: &quot;********&quot;, &quot;accountType&quot;: &quot;CACC&quot;, &quot;ispb&quot;: &quot;60701190&quot;, &quot;issuer&quot;: &quot;****&quot;, &quot;bank&quot;: { &quot;id&quot;: &quot;&quot; } } }  "},{"title":"Code: 409​","type":1,"pageTitle":"Get payment resource","url":"/docs/api-reference/customer/payments/get-resource#code-409","content":"{ &quot;code&quot;:401, &quot;message&quot;:&quot;Jwt is expired&quot;, &quot;data&quot;:null }  "},{"title":"Return code","type":0,"sectionRef":"#","url":"/docs/dev-guides/integration-api/code","content":"","keywords":""},{"title":"Common return code​","type":1,"pageTitle":"Return code","url":"/docs/dev-guides/integration-api/code#common-return-code","content":"Code\tMessage200\tOK 401\tAccess token is invalid 403\tThe initiation process has been suspended due to potential fraud. Please select a different payment method or attempt the initiation process with another institution. 405\tData info is null 409\t{ externalId, clientId } can not be duplicated, try another one. 422\tPayment Initiation error, invalid status. 500\tInternal server error 505\tRequest parameter missing or invalid 600\tInvalid route 602\tRequest body invalid 703\tMerchant code or secretKey invalid 704\tNo access permission "},{"title":"Create a payment initiation","type":0,"sectionRef":"#","url":"/docs/api-reference/customer/payments/create-payment","content":"","keywords":""},{"title":"Request​","type":1,"pageTitle":"Create a payment initiation","url":"/docs/api-reference/customer/payments/create-payment#request","content":""},{"title":"Getting started","type":0,"sectionRef":"#","url":"/docs/dev-guides/getting-started","content":"","keywords":""},{"title":"Request your test account​","type":1,"pageTitle":"Getting started","url":"/docs/dev-guides/getting-started#request-your-test-account","content":"If you don't have a testing account yet, please contact us via the following email: suporte@klavi.ai, and we will send you a testing account ASAP. At this stage, you will have access to your test Integration keys. Only after the conclusion of your negotiation and the integration process with our team, you will receive your live integration keys. "},{"title":"Start your integration​","type":1,"pageTitle":"Getting started","url":"/docs/dev-guides/getting-started#start-your-integration","content":"Once you have your test account, you can go over all the Klavi Payment solutions below and decide which integration best suits your platform. If you aren't sure, don’t worry, our Business Development Analyst will guide you. Payment page: The simplest and fastest integration method for payment initiation.Payment API: This approach requires partners to have back-end system development and integration capabilities. The Klavi payment initiation APIs can be divided into two categories according to specific purposes: Customer API: You can use such APIs to develop payment products for end users, and the Klavi payment White-label also uses such APIs to develop.Management API: You can use such APIs to develop management related products, and the Klavi Console is also developed based on such APIs. No matter you use the White-label or APIs provided by Klavi, you can use the Klavi Console for management, without additional development. "},{"title":"Test your integration​","type":1,"pageTitle":"Getting started","url":"/docs/dev-guides/getting-started#test-your-integration","content":"After getting started with tests in sandbox mode, you will need some fake customer data to complete the requests. If you are integrating with our Payment Page or Payment API, you can refer to our ERROR CODES page to get familiar with our error and hard decline messages. Those errors are returned from our API and they prevent a payment to be created. If you are using our Payment API, you can handle those errors, and show a more user-friendly message. When you finish your integration and your website is ready to go LIVE, you can either send a message to us through our integration Slack channel or by sending an email to suporte@klavi.ai requesting to certify your site. Once Klavi has certified your website’s integration, you will receive an email with your production (also known as live) integration key. After receiving this key, you need to follow these instructions before finishing up the setup: Replace the test key with the production key.Replace the URL prefix in every web service call – from https://payment-test.klavi.ai to https://payment.klavi.ai. Is everything done? Now you are LIVE and ready to start processing with us. note Before you get started: You must first create a Klavi payment account and create an API accessKey and secretKey. If you have any questions along the way, please don’t hesitate to talk to us at suporte@klavi.ai. "},{"title":"Overview","type":0,"sectionRef":"#","url":"/docs/dev-guides/overview","content":"Overview Welcome to the KlaviPay development documentation and API reference!","keywords":""},{"title":"Payment status","type":0,"sectionRef":"#","url":"/docs/dev-guides/integration-api/status","content":"","keywords":""},{"title":"General statuses​","type":1,"pageTitle":"Payment status","url":"/docs/dev-guides/integration-api/status#general-statuses","content":"Status\tDescriptionSTARTED\tAuthentication was done and the payment_initiation item was generated; ENQUEUED\tPayment Initiation enqueued; CONSENT_AWAITING_AUTHORIZATION\tAwaiting user authorization for consent; CONSENT_AUTHORIZED\tConsent authorized by user; PAYMENT_PENDING\tConsent consumed and Payment transaction is pending; PAYMENT_PARTIALLY_ACCEPTED\tWaiting for multiple authorizations; PAYMENT_SETTLEMENT_PROCESSING\tPayment initiation accepted and payment processing started; PAYMENT_SETTLEMENT_DEBTOR_ACCOUNT\tDebt made to the payer's account; PAYMENT_COMPLETED\tCredit made at the destination account; "},{"title":"Error statuses​","type":1,"pageTitle":"Payment status","url":"/docs/dev-guides/integration-api/status#error-statuses","content":"Status\tDescriptionCONSENT_REJECTED\tPayment rejected by user or consent expired; PAYMENT_REJECTED\tPayment instruction rejected; ERROR\tValidation failure or process error; CANCELED\tCanceled by any other means. "},{"title":"Request method​","type":1,"pageTitle":"Create a payment initiation","url":"/docs/api-reference/customer/payments/create-payment#request-method","content":"POST https://api-test.klavi.ai/payment/customer/v1/payments  "},{"title":"Request Header​","type":1,"pageTitle":"Create a payment initiation","url":"/docs/api-reference/customer/payments/create-payment#request-header","content":"Attribute\tType\tCondition\tDescriptionAuthorization\tString\trequired\tJWT bearer token obtained through /auth endpoint, When passing, add &quot;Bearer &quot; before the token "},{"title":"Request Path Parameters​","type":1,"pageTitle":"Create a payment initiation","url":"/docs/api-reference/customer/payments/create-payment#request-path-parameters","content":"None. "},{"title":"Request payload​","type":1,"pageTitle":"Create a payment initiation","url":"/docs/api-reference/customer/payments/create-payment#request-payload","content":"Attribute\tType\tCondition\tDescriptionexternalId\tString\toptional\tUsed by merchants to deliver their own customerId, UUID, or orderId related identification. participantId\tString\trequired redirectURL\tString\toptional user\tObject\trequired name\tString\toptional taxId\tString\trequired method\tString\trequired amount\tString\trequired\t "},{"title":"Response​","type":1,"pageTitle":"Create a payment initiation","url":"/docs/api-reference/customer/payments/create-payment#response","content":""},{"title":"Code: 200​","type":1,"pageTitle":"Create a payment initiation","url":"/docs/api-reference/customer/payments/create-payment#code-200","content":"{ &quot;id&quot;:&quot;9df0fd54-5df6-47b9-91e7-414d1c766d79&quot;, &quot;createdAt&quot;:&quot;2023-03-08T17:17:00.990Z&quot;, &quot;status&quot;:&quot;ENQUEUED&quot;, &quot;clientId&quot;:&quot;0b59d801-08e0-4e84-9ecd-569f34e32279&quot;, &quot;user&quot;:{ &quot;taxId&quot;:&quot;76109277673&quot;, &quot;name&quot;:&quot;dangwenyun12&quot; }, &quot;customerId&quot;:&quot;21a79744-39c8-4b37-b7a9-cb50b0389448&quot;, &quot;provider&quot;:{ &quot;tradeName&quot;:&quot;Klavi&quot;, &quot;avatar&quot;:&quot;https://media.licdn.com/dms/image/C4D0BAQGwqthFsnjhpw/company-logo_200_200/0/1647885722250?e=1681948800&amp;v=beta&amp;t=A7-Ks2EcodobZmHhOutvZ6IS3OgjfHDclmuS7sSjRfs&quot; }, &quot;externalId&quot;:&quot;wenyun15&quot;, &quot;participantId&quot;:&quot;c8f0bf49-4744-4933-8960-7add6e590841&quot;, &quot;amount&quot;:133300, &quot;fee&quot;:0, &quot;date&quot;:&quot;2023-03-08&quot;, &quot;method&quot;:&quot;PIX_INIC&quot;, &quot;debtor&quot;:{ &quot;bank&quot;:{ &quot;id&quot;:&quot;c8f0bf49-4744-4933-8960-7add6e590841&quot;, &quot;name&quot;:&quot;Mock Bank&quot;, &quot;avatar&quot;:&quot;https://cdn.raidiam.io/directory-ui/brand/obbrazil/0.2.0.112/favicon.svg&quot; } }, &quot;creditor&quot;:{ &quot;taxId&quot;:&quot;38231713000139&quot;, &quot;name&quot;:&quot;Klavi&quot;, &quot;ispb&quot;:&quot;60701190&quot;, &quot;issuer&quot;:&quot;****&quot;, &quot;number&quot;:&quot;********&quot;, &quot;accountType&quot;:&quot;CACC&quot;, &quot;bank&quot;:{ &quot;name&quot;:&quot;ITAÚ UNIBANCO S.A.&quot;, &quot;avatar&quot;:&quot;https://storage.googleapis.com/inic-data/60701190.svg&quot; } } }  "},{"title":"Code: 409​","type":1,"pageTitle":"Create a payment initiation","url":"/docs/api-reference/customer/payments/create-payment#code-409","content":"{ &quot;code&quot;: 409, &quot;message&quot;: &quot;{ externalId, clientId } can not be duplicated, try another one.&quot;, &quot;data&quot;: null }  "},{"title":"Payment API","type":0,"sectionRef":"#","url":"/docs/dev-guides/integration-api/api","content":"","keywords":""},{"title":"API invocation method​","type":1,"pageTitle":"Payment API","url":"/docs/dev-guides/integration-api/api#api-invocation-method","content":""},{"title":"Request URI​","type":1,"pageTitle":"Payment API","url":"/docs/dev-guides/integration-api/api#request-uri","content":"The request URI consists of the following parts: {URI-scheme}://{Host}/{resource-path}?{query-string}  Parameter description in URI: Parameter\tDescriptionURI-scheme\tAll APIs use HTTPS protocol, only support https. Host\tDifferent environments have different host: Sandbox environment: api-test.klavi.aiProduction environment: api.klavi.ai resource-path\tResource path, i.e. API access path. APIs with different functions have different resource paths. For example:The resource-path of the product API is payment/customer/v1/auth. The resource-path of the management API is payment/management/v1/auth. query-string\tQuery parameters are optional. Not every API has query parameters. Query parameters need to be preceded by a &quot;?&quot;, The form is parameter_name=parameter_value. For example, ?limit=10, which means no more than 10 pieces of data can be queried. caution Different environments have different host, only after the successful integration test in the sandbox environment can it be integrated in the production environment. Sandbox environment: api-test.klavi.ai/payment/customer/v1/authProduction environment: api.klavi.ai/payment/customer/v1/auth The credentials of the production environment is different from the sandbox environment, please reach out to us at crie@klavi.ai. "},{"title":"Request method​","type":1,"pageTitle":"Payment API","url":"/docs/dev-guides/integration-api/api#request-method","content":"Supported HTTP request methods: POST and GET. For GET method, only content type: application/x-www-form-url encoded protocol format is supported. For POST method, only content type: application/JSON is supported at present. "},{"title":"Character encoding​","type":1,"pageTitle":"Payment API","url":"/docs/dev-guides/integration-api/api#character-encoding","content":"UTF-8 coding. "},{"title":"Flows​","type":1,"pageTitle":"Payment API","url":"/docs/dev-guides/integration-api/api#flows","content":"The partner integration Klavi payment sequence diagrams is as follows:  "},{"title":"Start integrating Klavi payment​","type":1,"pageTitle":"Payment API","url":"/docs/dev-guides/integration-api/api#start-integrating-klavi-payment","content":""},{"title":"Step 1: Authentication​","type":1,"pageTitle":"Payment API","url":"/docs/dev-guides/integration-api/api#step-1-authentication","content":"Before request the Klavi payment API, you must first obtain a JWT bearer token by request the auth, once you have a JWT bearer token you can submit requests on protected APIs like participants and payments. curl 'https://api-test.klavi.ai/payment/customer/v1/auth' \\ -H 'Content-Type: application/json' \\ -d '{ &quot;accessKey&quot;: &quot;k0l1l2v3i4&quot;, &quot;secretKey&quot;: &quot;TtMdrH&amp;a8Mjd9FyULnFs*#dypaX15%qpXtXQt2n$&quot; }' response { &quot;token&quot;: &quot;eyJhbGciOiJFUzI1NiIsInR5cCI6IkpXVCJ9.eyJwYXlsbLWdhdGV3YXkifQ.2dvWMBcU87IeX4J7S1_bx1uKHsXAvSDaK0RdV9xq3-OSrLA&quot;, &quot;expire&quot;: &quot;2023-02-16T17:16:30.189341+08:00&quot; }  Refer: Authenticate initiation "},{"title":"Step 2: List Account Providers​","type":1,"pageTitle":"Payment API","url":"/docs/dev-guides/integration-api/api#step-2-list-account-providers","content":"Now that you have an access token, you can display the list of account providers participating in Open Finance to users. After the user selects his account holding institution, all you need to do is save the id for later use on the payments API. curl -L -X GET 'https://api-test.klavi.ai/payment/customer/v1/participants' \\ -H 'Content-Type: application/json' \\ -H 'Accept: application/json' \\ -H 'Authorization: Bearer 6IkpXVCJ9.eyJwYWdhdGV3YXkifQ.FKX8rT3jIFfeOLYTgTrzlSbOjMIMPAZipkH4VdhL-NB' response { [ { &quot;id&quot;: &quot;cc26199f-4949-4efd-9e1e-f21a34fd0239&quot;, &quot;name&quot;: &quot;Banco Bmg S.A&quot;, &quot;slug&quot;: &quot;banco-bmg-sa&quot;, &quot;avatar&quot;: &quot;https://www.bancobmg.com.br/data/files/8C/A2/7F/0A/FBA318104A94D208970BE9C2/bmg_open_finance.svg&quot; }, { &quot;id&quot;: &quot;f9cabb03-876d-4eea-974c-0d8ce4bd4860&quot;, &quot;name&quot;: &quot;banco Digio&quot;, &quot;slug&quot;: &quot;banco-digio&quot;, &quot;avatar&quot;: &quot;https://static.digio.com.br/media/logo_81e95ae2ab.svg&quot; }, { &quot;id&quot;: &quot;75db457a-612d-4d62-b557-ba9d32b05216&quot;, &quot;name&quot;: &quot;Banco do Brasil&quot;, &quot;slug&quot;: &quot;banco-do-brasil&quot;, &quot;avatar&quot;: &quot;https://www.bb.com.br/docs/pub/inst/img/LogoBB.svg&quot; }, { &quot;id&quot;: &quot;c3463f74-87b3-40bd-8d40-2a918f821e31&quot;, &quot;name&quot;: &quot;Banco Original S.A&quot;, &quot;slug&quot;: &quot;banco-original-sa&quot;, &quot;avatar&quot;: &quot;https://www.original.com.br/img/logo-cubo-verde.svg&quot; }, { &quot;id&quot;: &quot;612da9a3-ee82-4f9e-9919-fa8ba88800f9&quot;, &quot;name&quot;: &quot;Banco PAN&quot;, &quot;slug&quot;: &quot;banco-pan&quot;, &quot;avatar&quot;: &quot;https://www.bancopan.com.br/data/files/83/77/FC/2A/5DE5A71033FBD5979C288204/logo_pan_openbanking.svg&quot; } ] }  Refer: List participants "},{"title":"Step 3: Send payment payload​","type":1,"pageTitle":"Payment API","url":"/docs/dev-guides/integration-api/api#step-3-send-payment-payload","content":"Now that you have a JWT access token and the participantId that the end-user selected, it's time to show the checkout and to get the user confirmation on the payment transaction. Once confirmed, you need to send the payload of the payment to be enqueued and then processed. The example below displays the minimum payload information required: curl -L -X POST 'https://api-test.klavi.ai/payment/customer/v1/payments' \\ -H 'Accept: application/json' \\ -H 'Authorization: Bearer 6IkpXVCJ9.eyJwYWdhdGV3YXkifQ.FKX8rT3jIFfeOLYTgTrzlSbOjMIMPAZipkH4VdhL-NB ' \\ --data-raw '{ &quot;externalId&quot;: &quot;345590908&quot;, &quot;participantId&quot;: &quot;ef7320c1-6f96-4af5-9446-92a081b7eac9&quot;, &quot;redirectURL&quot;: &quot;https://app.sandbox.inic.dev/pag-receipt&quot;, &quot;user&quot;: { &quot;name&quot;: &quot;dang wenyun&quot;, &quot;taxId&quot;: &quot;12345678901&quot; }, &quot;method&quot;: &quot;PIX_INIC&quot;, &quot;amount&quot;: 133300, &quot;date&quot;: &quot;2023-02-16&quot; }' response { &quot;code&quot;: 409, &quot;message&quot;: &quot;{ externalId, clientId } can not be duplicated, try another one.&quot;, &quot;data&quot;: null }  Refer: Create a payment initiation "},{"title":"Step 4: Check status until completed, rejected or error​","type":1,"pageTitle":"Payment API","url":"/docs/dev-guides/integration-api/api#step-4-check-status-until-completed-rejected-or-error","content":"Congratulations, you have now sent the payload of the payment initiation! Now you can check the payment initiation status through the endpoint /v1/payments/:id/status. It only returns information to direct your next steps. Polling should be done in 1s intervals. A happy path should display the responses below, in this exact order: curl -L -X GET 'https://api-test.klavi.ai/payment/customer/v1/payments/fcb72e3a-b346-4f71-b044-971dc23232c9/status' \\ -H 'Accept: application/json' \\ -H 'Authorization: Bearer 6IkpXVCJ9.eyJwYWdhdGV3YXkifQ.FKX8rT3jIFfeOLYTgTrzlSbOjMIMPAZipkH4VdhL-NB' response { &quot;id&quot;: &quot;e8a1f1e1-cfe3-41b9-84c1-8653f645e58a&quot;, &quot;createdAt&quot;: &quot;2022-09-23T19:57:38.478Z&quot;, &quot;updatedAt&quot;: &quot;2022-09-23T19:58:18.591Z&quot;, &quot;consentId&quot;: &quot;urn:raidiambank:baa1479d-1af0-41f1-9a6a-82512796c003&quot;, &quot;endToEndId&quot;: &quot;E30980539202209231958U824f4f92b8&quot;, &quot;status&quot;: &quot;PAYMENT_REJECTED&quot;, &quot;externalId&quot;: &quot;345590908&quot;, &quot;errors&quot;: [ { &quot;code&quot;: &quot;DETALHE_PGTO_INVALIDO&quot;, &quot;detail&quot;: &quot;DETALHE_PGTO_INVALIDO&quot;, &quot;title&quot;: &quot;Detalhe do pagamento inválido.&quot; } ] }  Refer: Get the payment status If there is any problem in the integration, we will provide support in the way you think is most appropriate, not limited to Slack, Teams or email, please reach out to us at crie@klavi.ai. "},{"title":"Security","type":0,"sectionRef":"#","url":"/docs/dev-guides/security","content":"Security We deeply understand the importance of data security for payment initiation business. All requests must be done using HTTPS and our access tokens have expiration time definitions according to the Brazilian Open Finance specifications. Our keys are all secured by AWS CloudHSM, which is FIPS verified hardware. Passwords saved on our database are always encrypted with high security algorithms(RSA256). We use AWS as the infrastructure and strictly follow cloud native best practices in terms of compliance, network isolation VPC, resource access rights, vulnerability detection, etc.","keywords":""},{"title":"Payment page","type":0,"sectionRef":"#","url":"/docs/dev-guides/integration-page/page","content":"","keywords":""},{"title":"Use web integrate to your product​","type":1,"pageTitle":"Payment page","url":"/docs/dev-guides/integration-page/page#use-web-integrate-to-your-product","content":""},{"title":"web application customization​","type":1,"pageTitle":"Payment page","url":"/docs/dev-guides/integration-page/page#web-application-customization","content":"Klavi payment white label application support certain customization, such as font and its size, page style, title and other information. please reach out to us at suporte@klavi.ai. "},{"title":"Application request URI​","type":1,"pageTitle":"Payment page","url":"/docs/dev-guides/integration-page/page#application-request-uri","content":"The request URI consists of the following parts: {URI-scheme}://{Host}/{resource-path}?{query-string}  Parameter description in URI: Parameter\tDescriptionURI-scheme\tAll APIs use HTTPS protocol. Host\tDifferent environments have different host: Sandbox environment: payment-test.klavi.aiProduction environment: payment.klavi.ai resource-path\tResource path, if you use the white label integration method, the resource path is appId. For example: If your appId is xxyyzz, the URI of the access white label web page is https://payment-test.klavi.ai/wl/xxyyzz query-string\tQuery parameters are optional, you can pass some information about your product to Klavi through this parameter to facilitate the subsequent correspondence with your product. For example, you can pass parameters such as uuid of your product. Query parameters need to be preceded by a &quot;?&quot;, The form is parameter_name=parameter_value. For example: ?uuid=2248U-445Ut-98iUs For example, the following access URL is correct: https://payment-test.klavi.ai/klavipay-wl/xxyyzz?uuid=2248U-445Ut-98iUs  caution Different environments have different host and appId, only after the successful integration test in the sandbox environment can it be integrated in the production environment. Sandbox environment: payment-test.klavi.ai/wl/{appId}Production environment: payment.klavi.ai/wl/{appId} The credentials of the production environment is different from the sandbox environment, please reach out to us at suporte@klavi.ai. "},{"title":"Two white label Integration method​","type":1,"pageTitle":"Payment page","url":"/docs/dev-guides/integration-page/page#two-white-label-integration-method","content":"Klavi payment white label web application supports WebView or iFrame integration. You can choose any of the methods that fits your business better. Integration with WebView​ With WebView integration, Klavi payment white label web application supports callback URL to notify the user whether all payment processes have been complete in Klavi environment. Launching of Klavi payment web application info To include a callback URL inside the full URL, the URL value must be processed in encodeURICompenent() function as below: “%3a” replaces “:”“%2f” replaces “/”“%3f” replaces “?”“%3d” replaces “=” When adding a callback_url in the integration, be sure to encode it, for example: var klaviHost = &quot;https://payment-test.klavi.ai/wl/xxyyzz?&quot; var callbackURI = &quot;https://partnerDomain.com?payment=succeed&quot; document.write(klaviHost + encodeURIComponent(callbackURI));  After encodeURICompenent(), The output result as bellow: https://payment-test.klavi.ai/wl/xxyyzz?success_url=https%3a%2f%2fpartnerDomain.com%3fpayment%3dsucceed  Get payment resultsCallback URL currently supports only one parameter: payment_status, there are three values as follows: Payment_status Value\tDescriptionsucceed\tPayment succeeded failed\tPayment failed for some reason cancelled\tEnd user actively cancel payment For example: callback() { const { payment_status: paymentStatus } = this.$route.query; // logic according to payment_status switch(paymentStatus) { case 1: // succeed logic break; case 2: // failed logic break; case 3: // cancelled logic break; default: break; } }  Integration with iFrame​ With iFrame integration, Klavi payment white label web application will send event messages to the caller through targetWindows.postMessage() for the caller to control the user process according to the message results. note For more technical details of the Inline Frame element and targetWindows.postMessage(), please refer to the following link: https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframehttps://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage Event tracking Klavi payment white label application supports event tracking of the Link pages, if required.The following is an example of event tracking messages for iFrame integration through targetWindows.postMessage(). Such events and messages are customizable. Event\tMessageOpen consent page\t{code:200,message:”OK”,event:”open_consent_page”} Click proceed button(Consent page)\t{code:200, message:”OK”, event:”consent_page-click_proceed_button”} Click back button(Consent page)\t{code:200, message:”OK”, event:”consent_page-click_back_button”} Click allow button(Confirm page)\t{code:200, message:”OK”, event:”confirm_page-click_allow_button”} Click back button(Confirm page)\t{code:200, message:”OK”, event:”confirm_page-click_back_button)”} Allow save payment detail information(complete page)\t{code:200, message:”OK”,event:”complete_page-allow_save_payment_detail_information”} Click finished button(complete page)\t{code:200, message:”OK”,event:”complete_page-click_flished_button”} "},{"title":"Flows​","type":1,"pageTitle":"Payment page","url":"/docs/dev-guides/integration-page/page#flows","content":"The user journey is as follows:  "}]