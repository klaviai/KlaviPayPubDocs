"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[368],{3905:(e,t,a)=>{a.d(t,{Zo:()=>m,kt:()=>k});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=n.createContext({}),s=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},m=function(e){var t=s(e.components);return n.createElement(p.Provider,{value:t},e.children)},d="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),d=s(a),u=r,k=d["".concat(p,".").concat(u)]||d[u]||c[u]||i;return a?n.createElement(k,o(o({ref:t},m),{},{components:a})):n.createElement(k,o({ref:t},m))}));function k(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=u;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[d]="string"==typeof e?e:r,o[1]=l;for(var s=2;s<i;s++)o[s]=a[s];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},7886:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>c,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var n=a(7462),r=(a(7294),a(3905));const i={title:"Payment page",sidebar_label:"Payment page",sidebar_position:1},o=void 0,l={unversionedId:"dev-guides/integration-page/page",id:"dev-guides/integration-page/page",title:"Payment page",description:"Use web integrate to your product",source:"@site/docs/dev-guides/integration-page/page.md",sourceDirName:"dev-guides/integration-page",slug:"/dev-guides/integration-page/page",permalink:"/docs/dev-guides/integration-page/page",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{title:"Payment page",sidebar_label:"Payment page",sidebar_position:1},sidebar:"defaultSidebar",previous:{title:"Getting started",permalink:"/docs/dev-guides/getting-started"},next:{title:"Payment API",permalink:"/docs/dev-guides/integration-api/api"}},p={},s=[{value:"Use web integrate to your product",id:"use-web-integrate-to-your-product",level:2},{value:"web application customization",id:"web-application-customization",level:3},{value:"Application request URI",id:"application-request-uri",level:3},{value:"Two white label Integration method",id:"two-white-label-integration-method",level:3},{value:"Integration with WebView",id:"integration-with-webview",level:4},{value:"Integration with iFrame",id:"integration-with-iframe",level:4},{value:"Flows",id:"flows",level:2}],m={toc:s},d="wrapper";function c(e){let{components:t,...i}=e;return(0,r.kt)(d,(0,n.Z)({},m,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"use-web-integrate-to-your-product"},"Use web integrate to your product"),(0,r.kt)("h3",{id:"web-application-customization"},"web application customization"),(0,r.kt)("p",null,"Klavi payment white label application support certain customization, such as font and its size, page style, title and other information. please reach out to us at ",(0,r.kt)("a",{parentName:"p",href:"mailto:suporte@klavi.ai"},"suporte@klavi.ai"),"."),(0,r.kt)("h3",{id:"application-request-uri"},"Application request URI"),(0,r.kt)("p",null,"The request URI consists of the following parts:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"{URI-scheme}://{Host}/{resource-path}?{query-string}\n")),(0,r.kt)("p",null,"Parameter description in URI:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"URI-scheme")),(0,r.kt)("td",{parentName:"tr",align:"left"},"All APIs use HTTPS protocol.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"Host")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Different environments have different host: ",(0,r.kt)("ul",null,(0,r.kt)("li",null,"Sandbox environment: ",(0,r.kt)("strong",{parentName:"td"},"payment-test.klavi.ai")),(0,r.kt)("li",null,"Production environment: ",(0,r.kt)("strong",{parentName:"td"},"payment.klavi.ai"))))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"resource-path")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Resource path, if you use the white label integration method, the resource path is appId. For example: If your ",(0,r.kt)("inlineCode",{parentName:"td"},"appId")," is ",(0,r.kt)("inlineCode",{parentName:"td"},"xxyyzz"),", the URI of the access white label web page is ",(0,r.kt)("inlineCode",{parentName:"td"},"https://payment-test.klavi.ai/wl/xxyyzz"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"query-string")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Query parameters are optional, you can pass some information about your product to Klavi through this parameter to facilitate the subsequent correspondence with your product. For example, you can pass parameters such as ",(0,r.kt)("inlineCode",{parentName:"td"},"uuid"),' of your product. Query parameters need to be preceded by a "?", The form is ',(0,r.kt)("inlineCode",{parentName:"td"},"parameter_name=parameter_value"),". For example: ",(0,r.kt)("inlineCode",{parentName:"td"},"?uuid=2248U-445Ut-98iUs"))))),(0,r.kt)("p",null,"For example, the following access URL is correct:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"https://payment-test.klavi.ai/klavipay-wl/xxyyzz?uuid=2248U-445Ut-98iUs\n")),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("strong",{parentName:"p"},"Different environments have different host and ",(0,r.kt)("inlineCode",{parentName:"strong"},"appId")),", only after the successful integration test in the sandbox environment can it be integrated in the production environment. "),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"Sandbox environment: ",(0,r.kt)("inlineCode",{parentName:"li"},"payment-test.klavi.ai/wl/{appId}")),(0,r.kt)("li",{parentName:"ul"},"Production environment: ",(0,r.kt)("inlineCode",{parentName:"li"},"payment.klavi.ai/wl/{appId}"))),(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("strong",{parentName:"p"},"The credentials of the production environment is different from the sandbox environment"),", please reach out to us at ",(0,r.kt)("a",{parentName:"p",href:"mailto:suporte@klavi.ai"},"suporte@klavi.ai"),".")),(0,r.kt)("h3",{id:"two-white-label-integration-method"},"Two white label Integration method"),(0,r.kt)("p",null,"Klavi payment white label web application supports WebView or iFrame integration. You can choose any of the methods that fits your business better."),(0,r.kt)("h4",{id:"integration-with-webview"},"Integration with WebView"),(0,r.kt)("p",null,"With WebView integration, Klavi payment white label web application supports callback URL to notify the user whether all payment processes have been complete in Klavi environment."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Launching of Klavi payment web application")),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"To include a callback URL inside the full URL, the URL value must be processed in ",(0,r.kt)("inlineCode",{parentName:"p"},"encodeURICompenent()")," function as below:"),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},"\u201c%3a\u201d replaces \u201c:\u201d"),(0,r.kt)("li",{parentName:"ul"},"\u201c%2f\u201d replaces \u201c/\u201d"),(0,r.kt)("li",{parentName:"ul"},"\u201c%3f\u201d replaces \u201c?\u201d"),(0,r.kt)("li",{parentName:"ul"},"\u201c%3d\u201d replaces \u201c=\u201d"))),(0,r.kt)("p",null,"When adding a callback_url in the integration, be sure to encode it, for example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:"showLineNumbers",showLineNumbers:!0},'var klaviHost = "https://payment-test.klavi.ai/wl/xxyyzz?"\nvar callbackURI = "https://partnerDomain.com?payment=succeed"\ndocument.write(klaviHost + encodeURIComponent(callbackURI));\n')),(0,r.kt)("p",null,"After ",(0,r.kt)("inlineCode",{parentName:"p"},"encodeURICompenent()"),", The output result as bellow:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"https://payment-test.klavi.ai/wl/xxyyzz?success_url=https%3a%2f%2fpartnerDomain.com%3fpayment%3dsucceed\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Get payment results"),"\nCallback URL currently supports only one parameter: ",(0,r.kt)("inlineCode",{parentName:"p"},"payment_status"),", there are three values as follows:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Payment_status  Value"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"succeed")),(0,r.kt)("td",{parentName:"tr",align:null},"Payment succeeded")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"failed")),(0,r.kt)("td",{parentName:"tr",align:null},"Payment failed for some reason")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"cancelled")),(0,r.kt)("td",{parentName:"tr",align:null},"End user actively cancel payment")))),(0,r.kt)("p",null,"For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js",metastring:"showLineNumbers",showLineNumbers:!0},"callback() {\n  const { payment_status: paymentStatus } = this.$route.query;\n  // logic according to payment_status\n  switch(paymentStatus) {\n    case 1:\n      // succeed logic\n      \n      break;\n    case 2:\n      // failed logic\n\n      break;\n    case 3:\n      // cancelled logic\n\n      break;\n    default:\n      break;\n  }\n}\n")),(0,r.kt)("h4",{id:"integration-with-iframe"},"Integration with iFrame"),(0,r.kt)("p",null,"With iFrame integration, Klavi payment white label web application will send event messages to the caller through ",(0,r.kt)("inlineCode",{parentName:"p"},"targetWindows.postMessage()")," for the caller to control the user process according to the message results."),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"For more technical details of the Inline Frame element and targetWindows.postMessage(),  please refer to the following link:"),(0,r.kt)("ul",{parentName:"admonition"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe"},"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage"},"https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage")))),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Event tracking")),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Klavi payment white label application supports event tracking of the Link pages, if required."),(0,r.kt)("li",{parentName:"ol"},"The following is an example of event tracking messages for iFrame integration through ",(0,r.kt)("inlineCode",{parentName:"li"},"targetWindows.postMessage()"),". Such events and messages are customizable.")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Event"),(0,r.kt)("th",{parentName:"tr",align:null},"Message"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Open consent page"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"{code:200,message:\u201dOK\u201d,event:\u201dopen_consent_page\u201d}"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Click proceed button(Consent page)"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"{code:200, message:\u201dOK\u201d, event:\u201dconsent_page-click_proceed_button\u201d}"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Click back button(Consent page)"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"{code:200, message:\u201dOK\u201d, event:\u201dconsent_page-click_back_button\u201d}"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Click allow button(Confirm page)"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"{code:200, message:\u201dOK\u201d, event:\u201dconfirm_page-click_allow_button\u201d}"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Click back button(Confirm page)"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"{code:200, message:\u201dOK\u201d, event:\u201dconfirm_page-click_back_button)\u201d}"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Allow save payment detail information(complete page)"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"{code:200, message:\u201dOK\u201d,event:\u201dcomplete_page-allow_save_payment_detail_information\u201d}"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"Click finished button(complete page)"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"{code:200, message:\u201dOK\u201d,event:\u201dcomplete_page-click_flished_button\u201d}"))))),(0,r.kt)("h2",{id:"flows"},"Flows"),(0,r.kt)("p",null,"The user journey is as follows:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Payment user journey",src:a(3209).Z,width:"1972",height:"564"})))}c.isMDXComponent=!0},3209:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/integrationWithWL-a039f2d801dbf0f6f891263e81022d1c.png"}}]);